function t(){let t=e.getState().flat();l.forEach((e,s)=>{0!==t[s]?(e.textContent=t[s],e.className="field-cell",e.classList.add(`field-cell--${t[s]}`)):(e.textContent="",e.className="field-cell")})}window.keyframeNames=window.keyframeNames||[];const e=new class{constructor(t){this.board=t||Array.from({length:4},()=>[,,,,].fill(0)),this.score=0,this.status="idle"}moveLeft(t=""){let e=this.board.map(t=>[...t]),s=this.board.map(t=>[...t]);for(let e=0;e<s.length;e++)for(let r=0;r<s.length;r++)0===s[e][r]&&s[e][r+1]>0?(s[e][r]=s[e][r+1],s[e][r+1]=0):0===s[e][r]&&s[e][r+2]>0?(s[e][r]=s[e][r+2],s[e][r+2]=0):0===s[e][r]&&s[e][r+3]>0&&(s[e][r]=s[e][r+3],s[e][r+3]=0),s[e][r]===s[e][r+1]?(s[e][r]=2*s[e][r],s[e][r+1]=0,t&&this.setScore(this.score+s[e][r])):s[e][r]===s[e][r+2]&&0===s[e][r+1]?(s[e][r]=2*s[e][r],s[e][r+2]=0,t&&this.setScore(this.score+s[e][r])):s[e][r]===s[e][r+3]&&0===s[e][r+1]&&0===s[e][r+2]&&(s[e][r]=2*s[e][r],s[e][r+3]=0,t&&this.setScore(this.score+s[e][r]));if(t)return this.boardsEqual(e,s);this.boardsEqual(e,s)||(this.board=s,this.generateTile()),this.lose()&&this.setStatus("lose"),this.win()&&this.setStatus("win")}canMoveLeft(){return this.moveLeft("check")}moveRight(t=""){let e=this.board.map(t=>[...t]),s=this.board.map(t=>[...t]);for(let e=0;e<s.length;e++)for(let r=s.length-1;r>=0;r--)0===s[e][r]&&s[e][r-1]>0?(s[e][r]=s[e][r-1],s[e][r-1]=0):0===s[e][r]&&s[e][r-2]>0?(s[e][r]=s[e][r-2],s[e][r-2]=0):0===s[e][r]&&s[e][r-3]>0&&(s[e][r]=s[e][r-3],s[e][r-3]=0),s[e][r]===s[e][r-1]?(s[e][r]=2*s[e][r],s[e][r-1]=0,t&&this.setScore(this.score+s[e][r])):s[e][r]===s[e][r-2]&&0===s[e][r-1]?(s[e][r]=2*s[e][r],s[e][r-2]=0,t&&this.setScore(this.score+s[e][r])):s[e][r]===s[e][r-3]&&0===s[e][r-1]&&0===s[e][r-2]&&(s[e][r]=2*s[e][r],s[e][r-3]=0,t&&this.setScore(this.score+s[e][r]));if(t)return this.boardsEqual(e,s);this.boardsEqual(e,s)||(this.board=s,this.generateTile()),this.lose()&&this.setStatus("lose"),this.win()&&this.setStatus("win")}canMoveRight(){return this.moveRight("check")}moveUp(t=""){let e=this.board.map(t=>[...t]),s=this.board.map(t=>[...t]);for(let e=0;e<s.length;e++)for(let r=0;r<s.length;r++)r<s.length-1&&0===s[r][e]&&s[r+1][e]>0?(s[r][e]=s[r+1][e],s[r+1][e]=0):r<s.length-2&&0===s[r][e]&&s[r+2][e]>0?(s[r][e]=s[r+2][e],s[r+2][e]=0):r<s.length-3&&0===s[r][e]&&s[r+3][e]>0&&(s[r][e]=s[r+3][e],s[r+3][e]=0),r<s.length-1&&s[r][e]===s[r+1][e]?(s[r][e]=2*s[r][e],s[r+1][e]=0,t&&this.setScore(this.score+s[r][e])):r<s.length-2&&s[r][e]===s[r+2][e]&&0===s[r+1][e]?(s[r][e]=2*s[r][e],s[r+2][e]=0,t&&this.setScore(this.score+s[r][e])):r<s.length-3&&s[r][e]===s[r+3][e]&&0===s[r+2][e]&&0===s[r+1][e]&&(s[r][e]=2*s[r][e],s[r+3][e]=0,t&&this.setScore(this.score+s[r][e]));if(t)return this.boardsEqual(e,s);this.boardsEqual(e,s)||(this.board=s,this.generateTile()),this.lose()&&this.setStatus("lose"),this.win()&&this.setStatus("win")}canMoveUp(){return this.moveUp("check")}moveDown(t=""){let e=this.board.map(t=>[...t]),s=this.board.map(t=>[...t]);for(let e=0;e<s.length;e++)for(let r=s.length-1;r>=0;r--)r>0&&0===s[r][e]&&s[r-1][e]>0?(s[r][e]=s[r-1][e],s[r-1][e]=0):r>1&&0===s[r][e]&&s[r-2][e]>0?(s[r][e]=s[r-2][e],s[r-2][e]=0):r>2&&0===s[r][e]&&s[r-3][e]>0&&(s[r][e]=s[r-3][e],s[r-3][e]=0),r>0&&s[r][e]===s[r-1][e]?(s[r][e]=2*s[r][e],s[r-1][e]=0,t&&this.setScore(this.score+s[r][e])):r>1&&s[r][e]===s[r-2][e]&&0===s[r-1][e]?(s[r][e]=2*s[r][e],s[r-2][e]=0,t&&this.setScore(this.score+s[r][e])):r>2&&s[r][e]===s[r-3][e]&&0===s[r-2][e]&&0===s[r-1][e]&&(s[r][e]=2*s[r][e],s[r-3][e]=0,t&&this.setScore(this.score+s[r][e]));if(t)return this.boardsEqual(e,s);this.boardsEqual(e,s)||(this.board=s,this.generateTile()),this.lose()&&this.setStatus("lose"),this.win()&&this.setStatus("win")}canMoveDown(){return this.moveDown("check")}getScore(){return this.score}setScore(t){this.score=t}getState(){return this.board}setStatus(t){this.status=t}generateTile(){let t=0;for(;t<1;){let e=[2,2,2,2,4,2,2,2,2,2],s=this.getRandomNum(0,3),r=this.getRandomNum(0,3);0===this.board[s][r]&&(this.board[s][r]=e[this.getRandomNum(0,9)],t++)}}boardsEqual(t,e){return t.every((t,s)=>t.every((t,r)=>t===e[s][r]))}lose(){return this.canMoveLeft()&&this.canMoveRight()&&this.canMoveUp()&&this.canMoveDown()}win(){return this.board.flat().some(t=>2048===t)}getStatus(){return this.status}getRandomNum(t,e){return Math.floor(Math.random()*(e-t+1))+t}start(){this.setStatus("playing"),this.generateTile(),this.generateTile()}restart(){this.setStatus("idle");let t=Array.from({length:4},()=>[,,,,].fill(0));this.board=t}},s=document.querySelector("button"),r=document.querySelector(".game-score"),a=document.querySelector(".message-start"),o=document.querySelector(".message-lose"),i=document.querySelector(".message-win"),l=Array.from(document.querySelectorAll("td")),n=document.querySelector(".game-field"),h=document.querySelector(".game-over"),c=document.styleSheets[0];s.addEventListener("click",()=>{if("idle"===e.getStatus())e.start(),t(),a.classList.add("hidden"),s.classList.remove("start"),s.classList.add("restart"),s.textContent="Restart";else{e.restart(),t(),e.setScore(0),r.textContent=e.getScore(),a.classList.remove("hidden"),o.classList.add("hidden"),n.classList.remove("game-field--lose"),h.classList.remove("game-over--visible"),s.classList.remove("restart"),s.classList.add("start"),s.textContent="Start",l.forEach(t=>{t.style.animationName=""});for(let t=c.cssRules.length-1;t>=0;t--){let e=c.cssRules[t];e.type===CSSRule.KEYFRAMES_RULE&&window.keyframeNames.includes(e.name)&&c.deleteRule(t)}}}),document.addEventListener("keydown",d=>{"playing"===e.getStatus()&&("ArrowUp"===d.key&&(e.moveUp(),t(),r.textContent=e.getScore()),"ArrowDown"===d.key&&(e.moveDown(),t(),r.textContent=e.getScore()),"ArrowLeft"===d.key&&(e.moveLeft(),t(),r.textContent=e.getScore()),"ArrowRight"===d.key&&(e.moveRight(),t(),r.textContent=e.getScore())),"lose"===e.getStatus()&&(n.classList.add("game-field--lose"),o.classList.remove("hidden"),h.classList.add("game-over--visible"),l.forEach((t,e)=>{let s=`shake-${e}`,r=`@keyframes ${s} {`;for(let t=0;t<=80;t++){let e=(t%2==0?2:-2)*(t%4<2?1:-1),s=(t%2==0?2:-2)*(t%4<2?1:-1);r+=`${t}% { transform: rotate(${e}deg)
        translateX(${s}px) scale(1); }`}let a=(Math.random()-.5)*1e3,o=(Math.random()-.5)*1e3,i=(Math.random()-.5)*1440;r+=`
        80% { transform: rotate(0deg) translate(0,0); opacity: 1 }
        100% { transform: rotate(${i}deg) translate(${a}px,
        ${o}px); opacity: 0;}
      }`,c.insertRule(r,c.cssRules.length),t.style.animationName=s,t.style.animationDelay=`${.2*Math.random()}s`,t.style.animationDuration=`${1.5+Math.random()}s`,t.style.animationFillMode="forwards"}),o.addEventListener("click",()=>{e.restart(),t(),e.setScore(0),r.textContent=e.getScore(),a.classList.remove("hidden"),o.classList.add("hidden"),n.classList.remove("game-field--lose"),h.classList.remove("game-over--visible"),s.classList.remove("restart"),s.classList.add("start"),s.textContent="Start",l.forEach(t=>{t.style.animationName=""});for(let t=c.cssRules.length-1;t>=0;t--){let e=c.cssRules[t];e.type===CSSRule.KEYFRAMES_RULE&&window.keyframeNames.includes(e.name)&&c.deleteRule(t)}})),"win"===e.getStatus()&&(i.classList.remove("hidden"),i.addEventListener("click",()=>{e.restart(),t(),e.setScore(0),r.textContent=e.getScore(),a.classList.remove("hidden"),i.classList.add("hidden"),s.classList.remove("restart"),s.classList.add("start"),s.textContent="Start"}))});
//# sourceMappingURL=index.4ee4cc6c.js.map
