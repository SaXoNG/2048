!function(){function t(){var t=n.getState().flat();l.forEach(function(e,r){0!==t[r]?(e.textContent=t[r],e.className="field-cell",e.classList.add("field-cell--".concat(t[r]))):(e.textContent="",e.className="field-cell")})}window.keyframeNames=window.keyframeNames||[];function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function r(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return e(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n=new/*#__PURE__*/(function(){var t;function e(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.board=t||Array.from({length:4},function(){return[,,,,].fill(0)}),this.score=0,this.status="idle"}return t=[{key:"moveLeft",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.board.map(function(t){return r(t)}),n=this.board.map(function(t){return r(t)}),s=0;s<n.length;s++)for(var o=0;o<n.length;o++)0===n[s][o]&&n[s][o+1]>0?(n[s][o]=n[s][o+1],n[s][o+1]=0):0===n[s][o]&&n[s][o+2]>0?(n[s][o]=n[s][o+2],n[s][o+2]=0):0===n[s][o]&&n[s][o+3]>0&&(n[s][o]=n[s][o+3],n[s][o+3]=0),n[s][o]===n[s][o+1]?(n[s][o]=2*n[s][o],n[s][o+1]=0,t&&this.setScore(this.score+n[s][o])):n[s][o]===n[s][o+2]&&0===n[s][o+1]?(n[s][o]=2*n[s][o],n[s][o+2]=0,t&&this.setScore(this.score+n[s][o])):n[s][o]===n[s][o+3]&&0===n[s][o+1]&&0===n[s][o+2]&&(n[s][o]=2*n[s][o],n[s][o+3]=0,t&&this.setScore(this.score+n[s][o]));if(t)return this.boardsEqual(e,n);this.boardsEqual(e,n)||(this.board=n,this.generateTile()),this.lose()&&this.setStatus("lose"),this.win()&&this.setStatus("win")}},{key:"canMoveLeft",value:function(){return this.moveLeft("check")}},{key:"moveRight",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.board.map(function(t){return r(t)}),n=this.board.map(function(t){return r(t)}),s=0;s<n.length;s++)for(var o=n.length-1;o>=0;o--)0===n[s][o]&&n[s][o-1]>0?(n[s][o]=n[s][o-1],n[s][o-1]=0):0===n[s][o]&&n[s][o-2]>0?(n[s][o]=n[s][o-2],n[s][o-2]=0):0===n[s][o]&&n[s][o-3]>0&&(n[s][o]=n[s][o-3],n[s][o-3]=0),n[s][o]===n[s][o-1]?(n[s][o]=2*n[s][o],n[s][o-1]=0,t&&this.setScore(this.score+n[s][o])):n[s][o]===n[s][o-2]&&0===n[s][o-1]?(n[s][o]=2*n[s][o],n[s][o-2]=0,t&&this.setScore(this.score+n[s][o])):n[s][o]===n[s][o-3]&&0===n[s][o-1]&&0===n[s][o-2]&&(n[s][o]=2*n[s][o],n[s][o-3]=0,t&&this.setScore(this.score+n[s][o]));if(t)return this.boardsEqual(e,n);this.boardsEqual(e,n)||(this.board=n,this.generateTile()),this.lose()&&this.setStatus("lose"),this.win()&&this.setStatus("win")}},{key:"canMoveRight",value:function(){return this.moveRight("check")}},{key:"moveUp",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.board.map(function(t){return r(t)}),n=this.board.map(function(t){return r(t)}),s=0;s<n.length;s++)for(var o=0;o<n.length;o++)o<n.length-1&&0===n[o][s]&&n[o+1][s]>0?(n[o][s]=n[o+1][s],n[o+1][s]=0):o<n.length-2&&0===n[o][s]&&n[o+2][s]>0?(n[o][s]=n[o+2][s],n[o+2][s]=0):o<n.length-3&&0===n[o][s]&&n[o+3][s]>0&&(n[o][s]=n[o+3][s],n[o+3][s]=0),o<n.length-1&&n[o][s]===n[o+1][s]?(n[o][s]=2*n[o][s],n[o+1][s]=0,t&&this.setScore(this.score+n[o][s])):o<n.length-2&&n[o][s]===n[o+2][s]&&0===n[o+1][s]?(n[o][s]=2*n[o][s],n[o+2][s]=0,t&&this.setScore(this.score+n[o][s])):o<n.length-3&&n[o][s]===n[o+3][s]&&0===n[o+2][s]&&0===n[o+1][s]&&(n[o][s]=2*n[o][s],n[o+3][s]=0,t&&this.setScore(this.score+n[o][s]));if(t)return this.boardsEqual(e,n);this.boardsEqual(e,n)||(this.board=n,this.generateTile()),this.lose()&&this.setStatus("lose"),this.win()&&this.setStatus("win")}},{key:"canMoveUp",value:function(){return this.moveUp("check")}},{key:"moveDown",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.board.map(function(t){return r(t)}),n=this.board.map(function(t){return r(t)}),s=0;s<n.length;s++)for(var o=n.length-1;o>=0;o--)o>0&&0===n[o][s]&&n[o-1][s]>0?(n[o][s]=n[o-1][s],n[o-1][s]=0):o>1&&0===n[o][s]&&n[o-2][s]>0?(n[o][s]=n[o-2][s],n[o-2][s]=0):o>2&&0===n[o][s]&&n[o-3][s]>0&&(n[o][s]=n[o-3][s],n[o-3][s]=0),o>0&&n[o][s]===n[o-1][s]?(n[o][s]=2*n[o][s],n[o-1][s]=0,t&&this.setScore(this.score+n[o][s])):o>1&&n[o][s]===n[o-2][s]&&0===n[o-1][s]?(n[o][s]=2*n[o][s],n[o-2][s]=0,t&&this.setScore(this.score+n[o][s])):o>2&&n[o][s]===n[o-3][s]&&0===n[o-2][s]&&0===n[o-1][s]&&(n[o][s]=2*n[o][s],n[o-3][s]=0,t&&this.setScore(this.score+n[o][s]));if(t)return this.boardsEqual(e,n);this.boardsEqual(e,n)||(this.board=n,this.generateTile()),this.lose()&&this.setStatus("lose"),this.win()&&this.setStatus("win")}},{key:"canMoveDown",value:function(){return this.moveDown("check")}},{key:"getScore",value:function(){return this.score}},{key:"setScore",value:function(t){this.score=t}},{key:"getState",value:function(){return this.board}},{key:"setStatus",value:function(t){this.status=t}},{key:"generateTile",value:function(){for(var t=0;t<1;){var e=[2,2,2,2,4,2,2,2,2,2],r=this.getRandomNum(0,3),n=this.getRandomNum(0,3);0===this.board[r][n]&&(this.board[r][n]=e[this.getRandomNum(0,9)],t++)}}},{key:"boardsEqual",value:function(t,e){return t.every(function(t,r){return t.every(function(t,n){return t===e[r][n]})})}},{key:"lose",value:function(){return this.canMoveLeft()&&this.canMoveRight()&&this.canMoveUp()&&this.canMoveDown()}},{key:"win",value:function(){return this.board.flat().some(function(t){return 2048===t})}},{key:"getStatus",value:function(){return this.status}},{key:"getRandomNum",value:function(t,e){return Math.floor(Math.random()*(e-t+1))+t}},{key:"start",value:function(){this.setStatus("playing"),this.generateTile(),this.generateTile()}},{key:"restart",value:function(){this.setStatus("idle");var t=Array.from({length:4},function(){return[,,,,].fill(0)});this.board=t}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,t),e}()),s=document.querySelector("button"),o=document.querySelector(".game-score"),a=document.querySelector(".message-start"),i=document.querySelector(".message-lose"),c=document.querySelector(".message-win"),l=Array.from(document.querySelectorAll("td")),u=document.querySelector(".game-field"),h=document.querySelector(".game-over"),d=document.styleSheets[0];s.addEventListener("click",function(){if("idle"===n.getStatus())n.start(),t(),a.classList.add("hidden"),s.classList.remove("start"),s.classList.add("restart"),s.textContent="Restart";else{n.restart(),t(),n.setScore(0),o.textContent=n.getScore(),a.classList.remove("hidden"),i.classList.add("hidden"),u.classList.remove("game-field--lose"),h.classList.remove("game-over--visible"),s.classList.remove("restart"),s.classList.add("start"),s.textContent="Start",l.forEach(function(t){t.style.animationName=""});for(var e=d.cssRules.length-1;e>=0;e--){var r=d.cssRules[e];r.type===CSSRule.KEYFRAMES_RULE&&window.keyframeNames.includes(r.name)&&d.deleteRule(e)}}}),document.addEventListener("keydown",function(e){"playing"===n.getStatus()&&("ArrowUp"===e.key&&(n.moveUp(),t(),o.textContent=n.getScore()),"ArrowDown"===e.key&&(n.moveDown(),t(),o.textContent=n.getScore()),"ArrowLeft"===e.key&&(n.moveLeft(),t(),o.textContent=n.getScore()),"ArrowRight"===e.key&&(n.moveRight(),t(),o.textContent=n.getScore())),"lose"===n.getStatus()&&(u.classList.add("game-field--lose"),i.classList.remove("hidden"),h.classList.add("game-over--visible"),l.forEach(function(t,e){for(var r="shake-".concat(e),n="@keyframes ".concat(r," {"),s=0;s<=80;s++){var o=(s%2==0?2:-2)*(s%4<2?1:-1),a=(s%2==0?2:-2)*(s%4<2?1:-1);n+="".concat(s,"% { transform: rotate(").concat(o,"deg)\n        translateX(").concat(a,"px) scale(1); }")}var i=(Math.random()-.5)*1e3,c=(Math.random()-.5)*1e3,l=(Math.random()-.5)*1440;n+="\n        80% { transform: rotate(0deg) translate(0,0); opacity: 1 }\n        100% { transform: rotate(".concat(l,"deg) translate(").concat(i,"px,\n        ").concat(c,"px); opacity: 0;}\n      ")+"}",d.insertRule(n,d.cssRules.length),t.style.animationName=r,t.style.animationDelay="".concat(.2*Math.random(),"s"),t.style.animationDuration="".concat(1.5+Math.random(),"s"),t.style.animationFillMode="forwards"}),i.addEventListener("click",function(){n.restart(),t(),n.setScore(0),o.textContent=n.getScore(),a.classList.remove("hidden"),i.classList.add("hidden"),u.classList.remove("game-field--lose"),h.classList.remove("game-over--visible"),s.classList.remove("restart"),s.classList.add("start"),s.textContent="Start",l.forEach(function(t){t.style.animationName=""});for(var e=d.cssRules.length-1;e>=0;e--){var r=d.cssRules[e];r.type===CSSRule.KEYFRAMES_RULE&&window.keyframeNames.includes(r.name)&&d.deleteRule(e)}})),"win"===n.getStatus()&&(c.classList.remove("hidden"),c.addEventListener("click",function(){n.restart(),t(),n.setScore(0),o.textContent=n.getScore(),a.classList.remove("hidden"),c.classList.add("hidden"),s.classList.remove("restart"),s.classList.add("start"),s.textContent="Start"}))})}();
//# sourceMappingURL=index.04e528fd.js.map
